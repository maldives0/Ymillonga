{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport React, { useEffect, useCallback } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport AppLayout from '../components/AppLayout';\nimport PostForm from '../components/PostForm';\nimport PostCard from '../components/PostCard';\nimport UserProfile from '../components/UserProfile';\nimport { LOAD_POSTS_REQUEST, LOAD_RELATED_POSTS_REQUEST } from '../reducers/post';\nimport { PageHeader, message, Button } from 'antd';\nimport Link from 'next/link';\nimport Router from 'next/router';\nimport { jsx as ___EmotionJSX } from \"@emotion/react\";\n\nvar Home = function Home() {\n  var dispatch = useDispatch();\n  var id = useSelector(function (state) {\n    var _state$user$me;\n\n    return (_state$user$me = state.user.me) === null || _state$user$me === void 0 ? void 0 : _state$user$me.id;\n  });\n  var mainPosts = useSelector(function (state) {\n    return state.post.mainPosts;\n  });\n  var hasMorePosts = useSelector(function (state) {\n    return state.post.hasMorePosts;\n  });\n  var loadPostsLoading = useSelector(function (state) {\n    return state.post.loadPostsLoading;\n  });\n  var reportPostDone = useSelector(function (state) {\n    return state.post.reportPostDone;\n  });\n  var reportPostError = useSelector(function (state) {\n    return state.post.reportPostError;\n  });\n  var retweetError = useSelector(function (state) {\n    return state.post.retweetError;\n  });\n  var me = useSelector(function (state) {\n    return state.user.me;\n  });\n  var loadMyInfoError = useSelector(function (state) {\n    return state.user.loadMyInfoError;\n  });\n  var ignoreError = useSelector(function (state) {\n    return state.user.ignoreError;\n  });\n  var unIgnoreError = useSelector(function (state) {\n    return state.user.unIgnoreError;\n  });\n  var ignoreDone = useSelector(function (state) {\n    return state.user.ignoreDone;\n  });\n  var unIgnoreDone = useSelector(function (state) {\n    return state.user.unIgnoreDone;\n  });\n  var onClickRelatedPosts = useCallback(function () {\n    if (!id) {\n      return alert('로그인이 필요합니다.');\n    }\n\n    dispatch({\n      type: LOAD_RELATED_POSTS_REQUEST\n    });\n  }, [id]);\n  useEffect(function () {\n    if (ignoreDone) {\n      message.success('차단되었습니다.', 5);\n    }\n\n    if (ignoreError) {\n      message.error(ignoreError, 5);\n    }\n  }, [ignoreDone, ignoreError]);\n  useEffect(function () {\n    if (unIgnoreDone) {\n      message.success('차단이 풀어졌습니다.', 5);\n    }\n\n    if (unIgnoreError) {\n      message.error(unIgnoreError, 5);\n    }\n  }, [unIgnoreDone, unIgnoreError]);\n  useEffect(function () {\n    if (reportPostDone) {\n      message.success('신고가 접수되었습니다. 빠른 시일 내로 조치하겠습니다.', 5);\n    }\n\n    if (reportPostError) {\n      message.error(reportPostError, 5);\n    }\n  }, [reportPostDone, reportPostError]);\n  useEffect(function () {\n    if (retweetError) {\n      alert(retweetError);\n    }\n  }, [retweetError]);\n  useEffect(function () {\n    if (loadMyInfoError) {\n      Router.replace('/');\n    }\n  }, [loadMyInfoError]);\n  useEffect(function () {\n    function onScroll() {\n      if (window.scrollY + document.documentElement.clientHeight > document.documentElement.scrollHeight - 300) {\n        if (hasMorePosts && !loadPostsLoading) {\n          var _mainPosts;\n\n          var lastId = (_mainPosts = mainPosts[mainPosts.length - 1]) === null || _mainPosts === void 0 ? void 0 : _mainPosts.id;\n          dispatch({\n            type: LOAD_POSTS_REQUEST,\n            lastId: lastId\n          });\n        }\n      }\n    }\n\n    window.addEventListener('scroll', onScroll);\n    return function () {\n      //쌓여있는 이벤트 메모리를 제거해주기\n      window.removeEventListener('scroll', onScroll);\n    };\n  }, [mainPosts, hasMorePosts, loadPostsLoading]);\n  return ___EmotionJSX(AppLayout, null, me && me.id && ___EmotionJSX(Button, {\n    style: {\n      marginBottom: 5\n    },\n    loading: loadPostsLoading,\n    onClick: onClickRelatedPosts\n  }, ___EmotionJSX(Link, {\n    href: \"/posts/related\"\n  }, ___EmotionJSX(\"a\", null, \"\\uD314\\uB85C\\uC789 \\uAC8C\\uC2DC\\uAE00\\uB9CC \\uBCF4\\uAE30\"))), me && me.id && ___EmotionJSX(UserProfile, null), me ? ___EmotionJSX(PostForm, null) : ___EmotionJSX(PageHeader, {\n    className: \"site-page-header\",\n    onBack: function onBack() {\n      return Router.push('/login');\n    },\n    title: \"\\uB2F9\\uC2E0\\uC758 \\uBC00\\uB871\\uAC00 \\uACBD\\uD5D8\\uC744 \\uACF5\\uC720\\uD574\\uC8FC\\uC138\\uC694!\",\n    subTitle: \"\\uB85C\\uADF8\\uC778 \\uD6C4 \\uAC8C\\uC2DC\\uAE00\\uC744 \\uC791\\uC131\\uD574\\uBCF4\\uC138\\uC694.\"\n  }), mainPosts === null || mainPosts === void 0 ? void 0 : mainPosts.map(function (post) {\n    return ___EmotionJSX(PostCard, {\n      key: post.id,\n      post: post\n    });\n  }));\n};\n\nexport var __N_SSP = true;\nexport default Home;","map":null,"metadata":{},"sourceType":"module"}